<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tech Stack Menu & Exporter</title>
  <style>
    :root { --bg:#0f172a; --panel:#111827; --ink:#e5e7eb; --mute:#9ca3af; --accent:#22c55e; --accent2:#60a5fa; }
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--ink);font:14px/1.4 system-ui,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif}
    .container{max-width:1100px;margin:32px auto;padding:0 16px}
    .card{background:var(--panel);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.35);overflow:hidden}
    .card-hd{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:16px 18px;border-bottom:1px solid #1f2937}
    .title{font-size:18px;font-weight:700}
    .row{display:flex;gap:18px;align-items:center;flex-wrap:wrap}
    .controls{display:flex;gap:12px;flex-wrap:wrap}
    button{appearance:none;border:1px solid #374151;background:#0b1220;color:var(--ink);padding:10px 12px;border-radius:12px;cursor:pointer}
    button.primary{background:var(--accent);border-color:transparent;color:#052e16;font-weight:700}
    button.secondary{background:#0b1220}
    button:disabled{opacity:.5;cursor:not-allowed}
    input[type="search"]{background:#0b1220;color:var(--ink);border:1px solid #374151;border-radius:12px;padding:10px 12px;min-width:260px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px;padding:16px}
    details.cat{border:1px solid #1f2937;border-radius:14px;background:#0b1220}
    details>summary{list-style:none;cursor:pointer;padding:12px 14px;font-weight:700;display:flex;align-items:center;justify-content:space-between;gap:8px}
    details>summary::-webkit-details-marker{display:none}
    .muted{color:var(--mute)}
    .items{padding:8px 14px 14px 14px;display:flex;flex-direction:column;gap:8px}
    .item{display:flex;gap:10px;align-items:flex-start}
    .item label{cursor:pointer}
    .pill{font-size:11px;background:#0b253f;color:#cfe8ff;border:1px solid #1f3b5c;border-radius:999px;padding:2px 8px}
    .inline{display:flex;gap:8px;align-items:center}
    .footer{padding:12px 18px;border-top:1px solid #1f2937;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px}
    pre{background:#0b1220;border:1px solid #1f2937;border-radius:10px;padding:12px;overflow:auto;max-height:260px}
    .badge{font-weight:700;color:#052e16;background:var(--accent);padding:2px 8px;border-radius:999px}
    .selectall{margin-left:auto}
    .sr{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
  </style>
</head>
<body>
  <div class="container">
    <div class="card" id="app">
      <div class="card-hd">
        <div class="row">
          <div class="title">Tech Stack Menu</div>
          <div class="muted">Check items to assemble a product. Export or copy your package.</div>
        </div>
        <div class="controls">
          <input id="search" type="search" placeholder="Search items…" />
          <button id="expandAll" class="secondary" title="Expand all">Expand all</button>
          <button id="collapseAll" class="secondary" title="Collapse all">Collapse all</button>
          <button id="reset" class="secondary" title="Clear all selections">Reset</button>
          <button id="exportJson" class="primary" title="Download JSON">Export JSON</button>
          <button id="exportCsv" class="secondary" title="Download CSV">Export CSV</button>
          <button id="copyMd" class="secondary" title="Copy Markdown">Copy Markdown</button>
        </div>
      </div>

      <div class="grid" id="grid"></div>

      <div class="footer">
        <div class="inline">
          <span class="badge" id="count">0 selected</span>
          <span class="muted" id="status">No product yet.</span>
        </div>
        <div class="inline">
          <span class="muted">Preview</span>
        </div>
      </div>
      <div style="padding:0 18px 16px 18px">
        <pre id="preview" aria-label="Preview"></pre>
      </div>
    </div>
  </div>

<script>
// --- Data -----------------------------------------------------------------
// Keep labels tight and obvious. Keep bullets to 1-2.
const DATA = [
  { title: "AI / Automation", items: [
    { name: "Custom GPTs", bullets:["Task-specific agents","API-integrated workflows"] },
    { name: "OpenAI (Assistants, Whisper, ChatGPT)", bullets:["STT and intent parsing","Content generation"] },
    { name: "Make.com", bullets:["Multi-app integration","Schedulers and error handling"] },
    { name: "Pipedream", bullets:["Event-driven flows","Custom API glue"] },
    { name: "IFTTT", bullets:["Lightweight applets","Consumer device triggers"] },
  ]},
  { title: "Voice / Telephony / Messaging", items: [
    { name: "Twilio", bullets:["Voice/SMS APIs","Studio + link shortening"] },
    { name: "Bria", bullets:["Softphone","Desktop/mobile calling"] },
    { name: "OpenPhone", bullets:["Business numbers","Call/SMS mgmt"] },
    { name: "Vapi.ai", bullets:["Voice assistants","CS automation"] },
    { name: "Retell.ai", bullets:["Real-time call agents","Scripted voice flows"] },
    { name: "Textline", bullets:["Business SMS","CRM integration"] },
    { name: "WhatsApp / Messenger", bullets:["Customer messaging","Media sharing"] },
  ]},
  { title: "Web / Digital Presence", items: [
    { name: "SEO", bullets:["Keywords + metadata","SERP ranking"] },
    { name: "Google Business Listing / Reviews", bullets:["Local SEO","Reputation mgmt"] },
    { name: "WordPress", bullets:["CMS + plugins","Blog"] },
    { name: "Next.js / Astro", bullets:["Modern sites","Static + SSR"] },
    { name: "HTML/CSS/JS", bullets:["Custom UI","Lightweight pages"] },
    { name: "Misc Webforms", bullets:["Data capture","Lead intake"] },
    { name: "QR Codes", bullets:["Direct links","Checklist deep-links"] },
    { name: "YouTube", bullets:["Video hosting","Marketing channel"] },
  ]},
  { title: "Data / Storage / Productivity", items: [
    { name: "Airtable", bullets:["Structured tables","Views and filters"] },
    { name: "Notion", bullets:["Docs + tasks","Light databases"] },
    { name: "Google Drive", bullets:["Cloud files","Sharing"] },
    { name: "JotForm", bullets:["Forms","Automations"] },
    { name: "Google Maps / Embedded Map", bullets:["Lookup + routing","On-page map UI"] },
    { name: "Google Photos", bullets:["Image archive","Share"] },
    { name: "Diarium", bullets:["Journaling","Cross-device sync"] },
    { name: "Dropbox", bullets:["Cloud files","Sync"] },
    { name: "Evernote", bullets:["Notes","Searchable archive"] },
  ]},
  { title: "Finance / Payments", items: [
    { name: "QuickBooks Online", bullets:["Invoicing","Reconciliation"] },
    { name: "Stripe", bullets:["Online payments","Subscriptions"] },
    { name: "PayPal", bullets:["Processing","Transfers"] },
    { name: "Cash App / Zelle", bullets:["P2P","Direct bank moves"] },
    { name: "Online Banking / Hand Checking", bullets:["Biz banking","Manual checks"] },
  ]},
  { title: "Security / Access", items: [
    { name: "RoboForm", bullets:["Password mgmt","Secure sharing"] },
    { name: "Clear Token", bullets:["Identity verify","Access mgmt"] },
  ]},
  { title: "Media / Content", items: [
    { name: "Pocket Cast", bullets:["Podcasts","Subscriptions"] },
    { name: "Alexa", bullets:["Voice control","Smart home"] },
  ]},
  { title: "Remote Access / Surveillance", items: [
    { name: "RustDesk", bullets:["Remote desktop","File transfer"] },
    { name: "Blue Iris", bullets:["Video surveillance","Motion alerts"] },
  ]},
  { title: "Development / Tools", items: [
    { name: "FileZilla", bullets:["FTP/SFTP","Server file mgmt"] },
    { name: "MySQL", bullets:["Relational DB","SQL ops"] },
    { name: "PowerShell", bullets:["Automation scripts","Admin tasks"] },
    { name: "AutoHotKey", bullets:["Hotkeys","UI automation"] },
    { name: "VBA in Google Sheets & Docs", bullets:["Workspace automation","Custom logic"] },
    { name: "Cursor IDE", bullets:["Dev environment","AI coding assist"] },
  ]},
  { title: "Mapping / Routing", items: [
    { name: "Routing Software (Distance/Time/ETA)", bullets:["Optimized routes","Delivery efficiency"] },
  ]},
  { title: "Scheduling / Communication", items: [
    { name: "Google Calendar", bullets:["Events","Shared calendars"] },
    { name: "Discord", bullets:["Voice/video","Team collab"] },
  ]},
  { title: "Document & File Processing", items: [
    { name: "OCR", bullets:["Text from images","Invoice/receipt parse"] },
    { name: "Scanning (Receipts, Invoices, etc.)", bullets:["Digitize docs","Data extraction"] },
    { name: "Automated File Naming/Filing", bullets:["Consistent taxonomy","Fewer errors"] },
    { name: "Barcode File Labeling", bullets:["Physical↔digital link","Faster retrieval"] },
    { name: "Forms Routing / Approval", bullets:["Workflow","Sign-offs"] },
    { name: "Dashboards", bullets:["KPIs","Ops visibility"] },
    { name: "Chatbot", bullets:["Self-serve help","Lead triage"] },
  ]},
];

// --- Helpers ---------------------------------------------------------------
const slug = s => s.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'');
const $ = sel => document.querySelector(sel);
const $$ = sel => Array.from(document.querySelectorAll(sel));

// Persist selections
const STORAGE_KEY = 'techstack:selected:v1';
const loadState = () => JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
const saveState = (state) => localStorage.setItem(STORAGE_KEY, JSON.stringify(state));

// --- Render ----------------------------------------------------------------
const state = loadState();
const grid = $('#grid');

function render(){
  grid.innerHTML = '';
  DATA.forEach(cat => {
    const catId = slug(cat.title);
    const d = document.createElement('details');
    d.className = 'cat';
    d.id = `cat-${catId}`;
    d.open = true;

    const selectedInCat = (state[catId]||[]).length;
    d.innerHTML = `
      <summary>
        <span>${cat.title}</span>
        <span class="inline">
          <span class="pill" title="Selected in this category">${selectedInCat}/${cat.items.length}</span>
          <button class="secondary selectall" data-cat="${catId}" data-mode="all" title="Select all in ${cat.title}">All</button>
          <button class="secondary" data-cat="${catId}" data-mode="none" title="Clear all in ${cat.title}">None</button>
        </span>
      </summary>
      <div class="items"></div>
    `;

    const itemsWrap = d.querySelector('.items');
    cat.items.forEach(it => {
      const key = slug(it.name);
      const id = `${catId}__${key}`;
      const checked = (state[catId]||[]).includes(key);
      const bullets = it.bullets.map(b=>`<li>${b}</li>`).join('');
      const el = document.createElement('div');
      el.className = 'item';
      el.innerHTML = `
        <input id="${id}" type="checkbox" ${checked?'checked':''} data-cat="${catId}" data-key="${key}" />
        <label for="${id}">
          <div><strong>${it.name}</strong></div>
          <ul class="muted" style="margin:4px 0 0 0;padding-left:18px">${bullets}</ul>
        </label>
      `;
      itemsWrap.appendChild(el);
    });

    grid.appendChild(d);
  });

  bindEvents();
  updatePreview();
}

function bindEvents(){
  // Item toggle
  $$('#grid input[type="checkbox"]').forEach(cb => {
    cb.addEventListener('change', e => {
      const cat = e.target.dataset.cat;
      const key = e.target.dataset.key;
      state[cat] = state[cat] || [];
      if(e.target.checked){
        if(!state[cat].includes(key)) state[cat].push(key);
      } else {
        state[cat] = state[cat].filter(k=>k!==key);
        if(!state[cat].length) delete state[cat];
      }
      saveState(state);
      // update category pill
      const wrap = e.target.closest('details');
      const pill = wrap.querySelector('.pill');
      const catObj = DATA.find(c=>slug(c.title)===cat);
      pill.textContent = `${(state[cat]||[]).length}/${catObj.items.length}`;
      updatePreview();
    });
  });

  // Select all / none per category
  $$('#grid button[data-cat]').forEach(btn=>{
    btn.addEventListener('click', e => {
      e.preventDefault();
      const cat = e.currentTarget.dataset.cat;
      const mode = e.currentTarget.dataset.mode;
      const catObj = DATA.find(c=>slug(c.title)===cat);
      if(mode==='all') state[cat] = catObj.items.map(it=>slug(it.name));
      if(mode==='none') delete state[cat];
      saveState(state);
      render();
    });
  });
}

// --- Filters, Export, Preview ---------------------------------------------
$('#search').addEventListener('input', e => {
  const q = e.target.value.trim().toLowerCase();
  $$('#grid .item').forEach(item=>{
    const text = item.textContent.toLowerCase();
    item.style.display = text.includes(q) ? '' : 'none';
  });
});

$('#expandAll').addEventListener('click', ()=> $$('#grid details').forEach(d=>d.open=true));
$('#collapseAll').addEventListener('click', ()=> $$('#grid details').forEach(d=>d.open=false));
$('#reset').addEventListener('click', ()=>{ for(const k in state) delete state[k]; saveState(state); render(); });

function gatherSelection(){
  const out = [];
  DATA.forEach(cat=>{
    const catId = slug(cat.title);
    const picked = (state[catId]||[]);
    if(!picked.length) return;
    out.push({
      category: cat.title,
      items: cat.items.filter(it=>picked.includes(slug(it.name))).map(it=>({
        name: it.name,
        bullets: it.bullets
      }))
    });
  });
  return out;
}

function toCSV(selection){
  const rows = [['category','name','bullets']];
  selection.forEach(cat=>{
    cat.items.forEach(it=>{
      rows.push([cat.category, it.name, it.bullets.join(' | ')]);
    });
  });
  return rows.map(r=>r.map(v=>`"${String(v).replace(/"/g,'""')}"`).join(',')).join('\n');
}

function toMarkdown(selection){
  let md = '# Product Package\n\n';
  selection.forEach(cat=>{
    md += `## ${cat.category}\n`;
    cat.items.forEach(it=>{
      md += `- **${it.name}**\n`;
      it.bullets.forEach(b=> md += `  - ${b}\n`);
    });
    md += '\n';
  });
  return md;
}

function updatePreview(){
  const selection = gatherSelection();
  const json = JSON.stringify({
    id: `product-${Date.now()}`,
    created_at: new Date().toISOString(),
    selection
  }, null, 2);
  $('#preview').textContent = json;
  const total = selection.reduce((n,c)=>n+c.items.length,0);
  $('#count').textContent = `${total} selected`;
  $('#status').textContent = total? 'Ready to export.' : 'No product yet.';
  const disabled = total===0;
  ['exportJson','exportCsv','copyMd'].forEach(id=> $('#'+id).disabled = disabled);
}

function download(filename, content, type){
  const blob = new Blob([content], {type});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  URL.revokeObjectURL(a.href);
  a.remove();
}

$('#exportJson').addEventListener('click', ()=>{
  const selection = gatherSelection();
  const payload = {
    id: `product-${slug(new Date().toISOString())}`,
    created_at: new Date().toISOString(),
    selection
  };
  download(`${payload.id}.json`, JSON.stringify(payload, null, 2), 'application/json');
});

$('#exportCsv').addEventListener('click', ()=>{
  const selection = gatherSelection();
  download(`product-${Date.now()}.csv`, toCSV(selection), 'text/csv');
});

$('#copyMd').addEventListener('click', async ()=>{
  const selection = gatherSelection();
  const md = toMarkdown(selection);
  await navigator.clipboard.writeText(md);
  const s = $('#status');
  const prev = s.textContent; s.textContent = 'Markdown copied to clipboard';
  setTimeout(()=> s.textContent = prev, 1500);
});

// Init
render();
</script>
</body>
</html>
